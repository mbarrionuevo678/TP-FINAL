<div class="page-container">
    <div class="container">
        <div class="row">
            <app-breadcrumbs
                [steps]="[{name:'Inicio',link:'/home'}]">
            </app-breadcrumbs>
        </div>
        <div class="row">
            <div class="col-12">
                <h2 class="section-title my-4">Datos Generales</h2>
                <mat-card class="default-card p-4">
                    <mat-card-content>
                        <div class="info-grid info-grid-wide">
                            <div>
                                <span>Objeto</span>
                                <span>{{objectInfo.object}}</span>
                            </div>
                            <div>
                                <span>Identificador</span>
                                <span>{{objectInfo.id}}</span>
                            </div>
                            <div>
                                <span>CUIT</span>
                                <span>{{objectInfo.cuit}}</span>
                            </div>
                            <div>
                                <span>Nombre</span>
                                <span>{{objectInfo.fullName}}</span>
                            </div>
                            <div>
                                <span>Titular</span>
                                <span>{{objectInfo.holder}}</span>
                            </div>
                            <div>
                                <span>Tipo de Liquidación</span>
                                <span>{{objectInfo.settlementType}}</span>
                            </div>
                            <div>
                                <span>Domicilio</span>
                                <span>{{objectInfo.address}}</span>
                            </div>
                        </div>
                    </mat-card-content>
                </mat-card>
            </div>
        </div>
        <div class="row my-4">
            <div class="col-12">
                <h2 class="section-title my-4">Datos del Plan</h2>
                <mat-card class="default-card p-4" >
                    <mat-card-content>
                        <div class="info-grid info-grid-wide">
                            <div>
                                <span>Plan</span>
                                <span>{{planInfo.id}}</span>
                            </div>
                            <div>
                                <span>Fecha de Alta</span>
                                <span>{{planInfo.created_at | date: 'dd/MM/YYYY'}}</span>
                            </div>
                            <div>
                                <span>Forma de Pago</span>
                                <span>{{planInfo.payment_method}}</span>
                            </div>
                            <div>
                                <span>Responsable</span>
                                <span>{{planInfo.responsible}}</span>
                            </div>
                            <div>
                                <span>Nº Documento</span>
                                <span>{{planInfo.document_number}}</span>
                            </div>
                            <div>
                                <span>Tipo</span>
                                <span>{{planInfo.type}}</span>
                            </div>
                            <div>
                                <span>Caja</span>
                                <span>{{planInfo.fund}}</span>
                            </div>
                        </div>
                        <div class="bg-light p-4 br-1 mt-4">
                            <h3 class="sub-section-title section-border">Detalle de Deuda</h3>
                            <div class="row align-items-center">
                                <div class="row info-grid">
                                    <div>
                                        <span class="key">Deuda</span>
                                        <span class="value">$ {{planInfo.debt}}</span>
                                    </div>
                                    <div>
                                        <span class="key">Financia</span>
                                        <span class="value">$ {{planInfo.financed}}</span>
                                    </div>
                                    <div>
                                        <span class="key">Anticipo</span>
                                        <span class="value">$ {{planInfo.advance}}</span>
                                    </div>
                                    <div>
                                        <span class="key">Cuotas</span>
                                        <span class="value">{{planInfo.installments}}</span>
                                    </div>
                                    <div>
                                        <span class="key">Cuotas Atrasadas</span>
                                        <span class="value">{{planInfo.late_installments}}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row mt-4">
                            <div class="d-flex justify-content-evenly mt-4 mt-sm-0 d-sm-block text-end">
                                <button mat-raised-button color="primary">PAGAR</button>
                                <button mat-raised-button class="ms-sm-2">IMPRIMIR</button>
                            </div>
                        </div>
                        <div class="row">
                            <mat-tab-group mat-stretch-tabs="false" mat-align-tabs="start" dynamicHeight animationDuration="0ms">
                                <!-- TAB DEUDA -->
                                <mat-tab label="DEUDA">
                                    <div>
                                        <table mat-table [dataSource]="planInstallmentsDataSource" class="mt-4">
                                    
                                            <!-- Checkbox Column -->
                                            <ng-container matColumnDef="select">
                                                <th mat-header-cell *matHeaderCellDef>
                                                    <mat-checkbox color="primary" (change)="$event ? toggleAllRows() : null" [checked]="planInstallmentsSelection.hasValue() && isAllSelected()"
                                                        [indeterminate]="planInstallmentsSelection.hasValue() && !isAllSelected()" [aria-label]="checkboxLabel()">
                                                    </mat-checkbox>
                                                </th>
                                                <td mat-cell *matCellDef="let row">
                                                    <mat-checkbox color="primary" (click)="$event.stopPropagation()" (change)="$event ? planInstallmentsSelection.toggle(row) : null"
                                                        [checked]="planInstallmentsSelection.isSelected(row)" [aria-label]="checkboxLabel(row)">
                                                    </mat-checkbox>
                                                </td>
                                            </ng-container>
                                        
                                            <!-- Cuota Column -->
                                            <ng-container matColumnDef="installment">
                                                <th mat-header-cell *matHeaderCellDef> Cuota </th>
                                                <td mat-cell *matCellDef="let element"> {{element.installment}} </td>
                                            </ng-container>
                                            
                                            <!-- Nominal Column -->
                                            <ng-container matColumnDef="nominal">
                                                <th mat-header-cell *matHeaderCellDef class="mobile-hide"> Nominal </th>
                                                <td mat-cell *matCellDef="let element" class="mobile-hide"> {{element.nominal}}</td>
                                            </ng-container>

                                            <!-- Cubierto Column -->
                                            <ng-container matColumnDef="paid">
                                                <th mat-header-cell *matHeaderCellDef> Cubierto </th>
                                                <td mat-cell *matCellDef="let element"> {{element.paid}}</td>
                                            </ng-container>

                                            <!-- Recarga Column -->
                                            <ng-container matColumnDef="recharge">
                                                <th mat-header-cell *matHeaderCellDef> Recargo </th>
                                                <td mat-cell *matCellDef="let element"> {{element.recharge}} </td>
                                            </ng-container>    
                                            
                                            <!-- Total Column -->
                                            <ng-container matColumnDef="total">
                                                <th mat-header-cell *matHeaderCellDef> Total </th>
                                                <td mat-cell *matCellDef="let element"> ${{element.total}} </td>
                                            </ng-container>
                                            
                                            <!-- Vencimiento Column -->
                                            <ng-container matColumnDef="expiration">
                                                <th mat-header-cell *matHeaderCellDef> Vencimiento </th>
                                                <td mat-cell *matCellDef="let element" [ngClass]="{'expirated': element.status == 'Deuda'}"> {{element.expiration | date: 'dd/MM/YYYY'}} 
                                                </td>
                                            </ng-container>

                                            <!-- Estado Column -->
                                            <ng-container matColumnDef="status">
                                                <th mat-header-cell *matHeaderCellDef> Estado </th>
                                                <td mat-cell *matCellDef="let element"> {{element.status}} </td>
                                            </ng-container>
                                        
                                            <tr mat-header-row *matHeaderRowDef="planInstallmentsDisplayedColumns"></tr>
                                            <tr mat-row *matRowDef="let row; columns: planInstallmentsDisplayedColumns;">
                                            </tr>
                                        </table>
                                    </div>
                                </mat-tab>
                                <!-- TAB PERIODOS -->
                                <mat-tab label="PERIODOS">
                                    <div>                                       
                                        <table mat-table [dataSource]="planPeriodsDataSource" class="mt-4">
                                        
                                            <!-- Cuota Column -->
                                            <ng-container matColumnDef="period">
                                                <th mat-header-cell *matHeaderCellDef> Período </th>
                                                <td mat-cell *matCellDef="let element"> {{element.period | date: 'MM/YYYY'}} </td>
                                            </ng-container>
                                            
                                            <!-- Vencimiento Column -->
                                            <ng-container matColumnDef="expiration">
                                                <th mat-header-cell *matHeaderCellDef> Vencimiento </th>
                                                <td mat-cell *matCellDef="let element"> {{element.expiration | date: 'dd/MM/YYYY'}} 
                                                </td>
                                            </ng-container>

                                            <!-- Nominal Column -->
                                            <ng-container matColumnDef="nominal">
                                                <th mat-header-cell *matHeaderCellDef class="mobile-hide"> Nominal </th>
                                                <td mat-cell *matCellDef="let element" class="mobile-hide"> {{element.nominal}}</td>
                                            </ng-container>

                                            
                                            <!-- Recarga Column -->
                                            <ng-container matColumnDef="recharge">
                                                <th mat-header-cell *matHeaderCellDef> Recargo </th>
                                                <td mat-cell *matCellDef="let element"> {{element.recharge}} </td>
                                            </ng-container>    
                                            
                                            <!-- Multa Column -->
                                            <ng-container matColumnDef="penalty">
                                                <th mat-header-cell *matHeaderCellDef> Multa </th>
                                                <td mat-cell *matCellDef="let element"> {{element.penalty}}</td>
                                            </ng-container>

                                            <!-- Total Column -->
                                            <ng-container matColumnDef="total">
                                                <th mat-header-cell *matHeaderCellDef> Total </th>
                                                <td mat-cell *matCellDef="let element"> ${{element.total}} </td>
                                            </ng-container>
                                            

                                            <!-- Estado Column -->
                                            <ng-container matColumnDef="reference">
                                                <th mat-header-cell *matHeaderCellDef> Referencia </th>
                                                <td mat-cell *matCellDef="let element"> {{element.reference}} </td>
                                            </ng-container>
                                        
                                            <tr mat-header-row *matHeaderRowDef="planPeriodsDisplayedColumns"></tr>
                                            <tr mat-row *matRowDef="let row; columns: planPeriodsDisplayedColumns;">
                                            </tr>
                                        </table>
                                    </div>
                                </mat-tab>
                            </mat-tab-group>
                        </div>
                    </mat-card-content>
                </mat-card>
            </div>
        </div>
    </div>
</div>
